version: v3
{{- $type := default .Env.SERVICE_TYPE "proxy" | lower -}}
{{- if eq $type "auth" }}
auth_service:
  cluster_name: "{{ default .Env.CLUSTER_NAME "" }}"
  enabled: true
teleport:
  storage:
    type: postgresql
    conn_string: "{{ default .Env.DATABASE_URL "" }}"
  auth_server: "127.0.0.1:3025"
{{- else }}
  enabled: false
{{- end }}
proxy_service:
{{- if eq $type "proxy" }}
  public_addr: "{{ default .Env.CLUSTER_NAME "" }}:443"
  enabled: true
teleport:
  auth_server: "{{ default .Env.AUTH_SERVER "" }}:3025"
{{- else }}
  enabled: false
{{- end }}
ssh_service:
  enabled: false
